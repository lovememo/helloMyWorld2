<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- 指定工作空间，要与接口名相同，源代码没有去看，猜测应该是通过"这里的namespace.下边方法的id"来定位方法的 -->
<mapper namespace="com.opm.core.paymanager.mapper.PayMapping">

	<!-- Map START -->
	<resultMap id="empPayNoteStaticModel" type="com.opm.core.paymanager.model.EmpPayNoteStatisticData">
		<result column="pay_bf_tax" property="pay_bf_tax"></result>
		<result column="taxed_offer_amt" property="taxed_offer_amt"></result>
		<result column="offer_amt" property="offer_amt"></result>
		<result column="payable_amt" property="payable_amt"></result>
		<result column="tax_amt" property="tax_amt"></result>
		<result column="pay_af_tax" property="pay_af_tax"></result>
	</resultMap>
	
	<select id="getStaticPayNoteData" resultMap="empPayNoteStaticModel">
		select sum(pay_bf_tax) pay_bf_tax,
			sum(taxed_offer_amt) taxed_offer_amt,
			sum(offer_amt) offer_amt,
			sum(payable_amt) payable_amt,
			sum(tax_amt) tax_amt,
			sum(pay_af_tax) pay_af_tax
		from opm_emp_paynote_trd
		where trd_no = #{tradeNo}
	</select>

	<!-- 若不需要自动返回主键，将useGeneratedKeys="true" keyProperty="id"去掉即可(当然如果不需要自动返回主键，直接用注解即可) -->
	<insert id="insertPayTrade">
		insert into
		OPM_PAY_REPORT_TRD(isrepay,pay_inform_date,pay_count,amt,amt_af_tax,tax_amt,state,trd_no)
		values(#{isrepay},#{pay_inform_date,jdbcType =
		VARCHAR},#{pay_count},#{amt},#{amt_af_tax},#{tax_amt},#{state},#{trd_no,jdbcType
		= VARCHAR})
	</insert>

	<update id="updatePayTradeStatus">
		update opm_pay_report_trd
		set state = #{state}
		where
		TRD_NO=#{tradeNo}
	</update>

</mapper>