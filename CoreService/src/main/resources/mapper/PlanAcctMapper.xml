<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.opm.core.plan.mapper.PlanAcctMapper">
	
	<resultMap id="planAcct" type="com.opm.core.plan.model.PlanAcctModel">
		<result column="APP_NO" property="appNo"></result>
		<result column="TRD_NO" property="trdNo"></result>
		<result column="PLAN_ID" property="planId"></result>
		<result column="FEE_TYPE" property="feeType"></result>
		<result column="INVEST_ID" property="investId"></result>
		<result column="ACCT_OPEN_DATE" property="acctOpenDate"></result>
		<result column="ACCT_NAME" property="acctName"></result>
		<result column="BANK_NAME" property="bankName"></result>
		<result column="BANK_NO" property="bankNo"></result>
		<result column="ACCT_NO" property="acctNo"></result>
		<result column="OPEN_BRANCH" property="openBranch"></result>
		<result column="ACCT_PROV" property="acctProv"></result>
		<result column="ACCT_CITY" property="acctCity"></result>
		<result column="UNION_BRANCH_ID" property="unionBranchId"></result>
	</resultMap>
	<!-- 基本信息app -->
	<select id="selectPlanAcctApp" resultMap="planAcct">
	 	select app_no,
		     plan_id,
		     fee_type,
		     invest_id,
		     acct_open_date,
		     acct_name,
		     bank_name,
		     bank_no,
		     acct_no,
		     open_branch,
		     acct_prov,
		     acct_city,
		     union_branch_id
		 from opm_acct_app
		where app_no = #{appNo, jdbcType = VARCHAR}
		    <if test="planId != null and planId != ''">
		   	 and  plan_id = #{planId, jdbcType = VARCHAR}
		   	</if>
		    <if test="feeType != null and feeType != ''">
		   	 and  fee_type = #{feeType, jdbcType = VARCHAR}
		   	</if>
		order by fee_type, invest_id
	</select>
	<insert id="insertPlanAcctApp" parameterType="com.opm.core.plan.model.PlanAcctModel">
	  INSERT INTO opm_acct_app
	    (app_no,
	     plan_id,
	     fee_type,
	     invest_id,
	     acct_open_date,
	     acct_name,
	     bank_name,
	     bank_no,
	     acct_no,
	     open_branch,
	     acct_prov,
	     acct_city,
	     union_branch_id)
	VALUES
		(#{appNo, jdbcType = VARCHAR},
		#{planId, jdbcType = VARCHAR},
		#{feeType, jdbcType = VARCHAR},
		#{investId, jdbcType = VARCHAR},
		#{acctOpenDate, jdbcType = VARCHAR},
		#{acctName, jdbcType = VARCHAR},
		#{bankName, jdbcType = VARCHAR},
		#{bankNo, jdbcType = VARCHAR},
		#{acctNo, jdbcType = VARCHAR},
		#{openBranch, jdbcType = VARCHAR},
		#{acctProv, jdbcType = VARCHAR},
		#{acctCity, jdbcType = VARCHAR},
		#{unionBranchId, jdbcType = VARCHAR}
	)
	</insert>
	<update id="updatePlanAcctApp" parameterType="com.opm.core.plan.model.PlanAcctModel">
		update opm_acct_app
		   set  acct_open_date = #{acctOpenDate, jdbcType = VARCHAR},
				acct_name = #{acctName, jdbcType = VARCHAR},
				bank_name = #{bankName, jdbcType = VARCHAR},
				bank_no = #{bankNo, jdbcType = VARCHAR},
				acct_no = #{acctNo, jdbcType = VARCHAR},
				open_branch = #{openBranch, jdbcType = VARCHAR},
				acct_prov = #{acctProv, jdbcType = VARCHAR},
				acct_city = #{acctCity, jdbcType = VARCHAR},
				union_branch_id = #{unionBranchId, jdbcType = VARCHAR}
		where app_no = #{appNo, jdbcType = VARCHAR}
		  and plan_id = #{planId, jdbcType = VARCHAR}
		  and invest_id = #{investId, jdbcType = VARCHAR}
		  and fee_type = #{feeType, jdbcType = VARCHAR}
	</update>
	<delete id="deletePlanAcctApp" parameterType="com.opm.core.plan.model.PlanAcctModel">
		delete from opm_acct_app
		where app_no = #{appNo, jdbcType = VARCHAR}
		  and plan_id = #{planId, jdbcType = VARCHAR}
		  and invest_id = #{investId, jdbcType = VARCHAR}
		  and fee_type = #{feeType, jdbcType = VARCHAR}
	</delete>

	<!-- 基本信息trd -->
	<insert id="insertPlanAcctTrd" parameterType="com.opm.core.plan.model.PlanAcctModel">
	INSERT INTO opm_acct_trd
		(trd_no,
	     plan_id,
	     fee_type,
	     invest_id,
	     acct_open_date,
	     acct_name,
	     bank_name,
	     bank_no,
	     acct_no,
	     open_branch,
	     acct_prov,
	     acct_city,
	     union_branch_id)
	VALUES
		(#{trdNo, jdbcType = VARCHAR},
		#{planId, jdbcType = VARCHAR},
		#{feeType, jdbcType = VARCHAR},
		#{investId, jdbcType = VARCHAR},
		#{acctOpenDate, jdbcType = VARCHAR},
		#{acctName, jdbcType = VARCHAR},
		#{bankName, jdbcType = VARCHAR},
		#{bankNo, jdbcType = VARCHAR},
		#{acctNo, jdbcType = VARCHAR},
		#{openBranch, jdbcType = VARCHAR},
		#{acctProv, jdbcType = VARCHAR},
		#{acctCity, jdbcType = VARCHAR},
		#{unionBranchId, jdbcType = VARCHAR}
	)
	</insert>
	
	<!-- 基本信息inf -->
	<insert id="insertPlanAcctInf" parameterType="com.opm.core.plan.model.PlanAcctModel">
	INSERT INTO opm_acct_inf
		(plan_id,
	     fee_type,
	     invest_id,
	     acct_open_date,
	     acct_name,
	     bank_name,
	     bank_no,
	     acct_no,
	     open_branch,
	     acct_prov,
	     acct_city,
	     union_branch_id)
	VALUES
		(#{planId, jdbcType = VARCHAR},
		#{feeType, jdbcType = VARCHAR},
		#{investId, jdbcType = VARCHAR},
		#{acctOpenDate, jdbcType = VARCHAR},
		#{acctName, jdbcType = VARCHAR},
		#{bankName, jdbcType = VARCHAR},
		#{bankNo, jdbcType = VARCHAR},
		#{acctNo, jdbcType = VARCHAR},
		#{openBranch, jdbcType = VARCHAR},
		#{acctProv, jdbcType = VARCHAR},
		#{acctCity, jdbcType = VARCHAR},
		#{unionBranchId, jdbcType = VARCHAR}
	)
	</insert>
	<select id="selectPlanAcctInf" resultMap="planAcct">
	 	select
	     plan_id,
	     fee_type,
	     invest_id,
	     acct_open_date,
	     acct_name,
	     bank_name,
	     bank_no,
	     acct_no,
	     open_branch,
	     acct_prov,
	     acct_city,
	     union_branch_id
		 from opm_acct_inf
		where plan_id = #{planId, jdbcType = VARCHAR}
	</select>
	<update id="updatePlanAcctInf" parameterType="com.opm.core.plan.model.PlanAcctModel">
		update opm_acct_inf
		   set  acct_open_date = #{acctOpenDate, jdbcType = VARCHAR},
				acct_name = #{acctName, jdbcType = VARCHAR},
				bank_name = #{bankName, jdbcType = VARCHAR},
				bank_no = #{bankNo, jdbcType = VARCHAR},
				acct_no = #{acctNo, jdbcType = VARCHAR},
				open_branch = #{openBranch, jdbcType = VARCHAR},
				acct_prov = #{acctProv, jdbcType = VARCHAR},
				acct_city = #{acctCity, jdbcType = VARCHAR},
				union_branch_id = #{unionBranchId, jdbcType = VARCHAR}
		where plan_id = #{planId, jdbcType = VARCHAR}
		  and invest_id = #{investId, jdbcType = VARCHAR}
		  and fee_type = #{feeType, jdbcType = VARCHAR}
	</update>
</mapper>